/*---------------------------------DROP TABLE-----------------------------------*/

/*
DROP TABLE T_SFE_DESAFIO CASCADE CONSTRAINTS;
DROP TABLE T_SFE_USUARIO CASCADE CONSTRAINTS;
DROP TABLE T_SFE_USUARIO_DESAFIO CASCADE CONSTRAINTS;
DROP TABLE T_SFE_ENTRETENIMENTO CASCADE CONSTRAINTS;
DROP TABLE T_SFE_USUARIO_ENTRETENIMENTO CASCADE CONSTRAINTS;
DROP TABLE T_SFE_FILME CASCADE CONSTRAINTS;
DROP TABLE T_SFE_USUARIO_FILME CASCADE CONSTRAINTS;
DROP TABLE T_SFE_EX_FISICO CASCADE CONSTRAINTS;
DROP TABLE T_SFE_USUARIO_EX_FISICO CASCADE CONSTRAINTS;
*/

/*--------------------------CREATE TABLE E ALTER TABLE--------------------------*/

CREATE TABLE T_SFE_DESAFIO(
    CD_DESAFIO      NUMBER(5)       NOT NULL,
    VL_PONTUACAO    NUMBER(3)       NOT NULL
);

ALTER TABLE T_SFE_DESAFIO 
    ADD CONSTRAINT PK_SFE_DESAFIO  
PRIMARY KEY ( CD_DESAFIO );

SELECT * FROM T_SFE_DESAFIO;

/*-------------------------------------------------------------------------------*/

CREATE TABLE T_SFE_USUARIO(
    CD_USUARIO      NUMBER(5)       NOT NULL,
    NM_USUARIO      VARCHAR2(50)    NOT NULL,
    DT_NASCIMENTO   DATE            NOT NULL,
    DS_EMAIL        VARCHAR2(60)    NOT NULL,
    DS_SENHA        VARCHAR2(20)    NOT NULL,
    DS_GENERO       CHAR(2)         NOT NULL,
    NR_TELEFONE     NUMBER(11)      
);

ALTER TABLE T_SFE_USUARIO
    ADD CONSTRAINT PK_SFE_USUARIO
PRIMARY KEY (CD_USUARIO);

SELECT * FROM T_SFE_USUARIO;

/*-------------------------------------------------------------------------------*/

CREATE TABLE T_SFE_USUARIO_DESAFIO(
    CD_USUARIO      NUMBER(5)       NOT NULL,
    CD_DESAFIO      NUMBER(5)       NOT NULL
);

ALTER TABLE T_SFE_USUARIO_DESAFIO 
    ADD CONSTRAINT PK_SFE_USU_DESA 
PRIMARY KEY ( CD_USUARIO, CD_DESAFIO );

SELECT * FROM T_SFE_USUARIO_DESAFIO;

/*-------------------------------------------------------------------------------*/

CREATE TABLE T_SFE_ENTRETENIMENTO(
    CD_ENTRETENIMENTO       NUMBER(1)       NOT NULL,
    DS_CATEGORIA            VARCHAR2(15)    NOT NULL
);

ALTER TABLE T_SFE_ENTRETENIMENTO 
    ADD CONSTRAINT PK_SFE_ENTRETENIMENTO
PRIMARY KEY ( CD_ENTRETENIMENTO );

SELECT * FROM T_SFE_ENTRETENIMENTO;

/*-------------------------------------------------------------------------------*/

CREATE TABLE T_SFE_USUARIO_ENTRETENIMENTO(
    CD_USUARIO          NUMBER(5)       NOT NULL,
    CD_ENTRETENIMENTO   NUMBER(5)       NOT NULL
);

ALTER TABLE T_SFE_USUARIO_ENTRETENIMENTO 
    ADD CONSTRAINT PK_SFE_USUARIO_ENTRETENIMENTO
PRIMARY KEY ( CD_USUARIO, CD_ENTRETENIMENTO );

SELECT * FROM T_SFE_USUARIO_ENTRETENIMENTO;


/*-------------------------------------------------------------------------------*/


CREATE TABLE T_SFE_FILME(
    CD_FILME        NUMBER(5)       NOT NULL,
    NM_FILME        VARCHAR2(40)    NOT NULL,  
    LIS_ELENCO      VARCHAR2(500)    NOT NULL,
    NM_DIRETOR      VARCHAR2(50)    NOT NULL,
    NM_ROTEIRISTA   VARCHAR2(50)    NOT NULL,
    NM_GENERO       VARCHAR2(70)    NOT NULL,
    DT_LANCAMENTO   DATE            NOT NULL,
    ST_DURACAO      NUMBER(5,2)     NOT NULL
    
);

ALTER TABLE T_SFE_FILME
    ADD CONSTRAINT PK_SFE_FILME
PRIMARY KEY ( CD_FILME );

SELECT * FROM T_SFE_FILME;

/*-------------------------------------------------------------------------------*/

CREATE TABLE T_SFE_USUARIO_FILME(
    CD_USUARIO      NUMBER(5)       NOT NULL,
    CD_FILME        NUMBER(5)       NOT NULL,
    ST_DURACAO      NUMBER(5,2)     NOT NULL
);

ALTER TABLE T_SFE_USUARIO_FILME
    ADD CONSTRAINT PK_SFE_USUARIO_FILME
PRIMARY KEY ( CD_USUARIO, CD_FILME );

SELECT * FROM T_SFE_USUARIO_FILME;

/*-------------------------------------------------------------------------------*/

CREATE TABLE T_SFE_EX_FISICO(
    CD_EXERCICIO        NUMBER(5)       NOT NULL,
    NM_EXERCICIO        VARCHAR2(100)    NOT NULL,
    NM_MODALIDADE       VARCHAR2(30)    NOT NULL,
    ST_DURACAO          NUMBER(5,2)     NOT NULL
);

ALTER TABLE T_SFE_EX_FISICO
    ADD CONSTRAINT PK_SFE_EX_FISICO
PRIMARY KEY ( CD_EXERCICIO );

ALTER TABLE T_SFE_EX_FISICO
    ADD CONSTRAINT UN_SFE_EX_FISICO_NOME 
UNIQUE ( NM_EXERCICIO );

SELECT * FROM T_SFE_EX_FISICO;

/*-------------------------------------------------------------------------------*/

CREATE TABLE T_SFE_USUARIO_EX_FISICO(
    CD_USUARIO      NUMBER(5)       NOT NULL,
    CD_EXERCICIO    NUMBER(5)       NOT NULL,
    ST_DURACAO      NUMBER(5,2)     NOT NULL
);

ALTER TABLE T_SFE_USUARIO_EX_FISICO
    ADD CONSTRAINT PK_SFE_USUARIO_EX_FISICO
PRIMARY KEY ( CD_USUARIO, CD_EXERCICIO );

SELECT * FROM T_SFE_USUARIO_EX_FISICO;



/*-----------------------------CHAVES ESTRANGEIRAS------------------------------*/
      
ALTER TABLE T_SFE_USUARIO_DESAFIO
ADD CONSTRAINT FK_SFE_USU_DESA_USUARIO
    FOREIGN KEY (CD_USUARIO)
    REFERENCES T_SFE_USUARIO (CD_USUARIO);
    
ALTER TABLE T_SFE_USUARIO_DESAFIO
ADD CONSTRAINT FK_SFE_USU_DESA_DESAFIO
    FOREIGN KEY (CD_DESAFIO)
    REFERENCES T_SFE_DESAFIO (CD_DESAFIO);

/*-------------------------------------------------------------------------------*/

ALTER TABLE T_SFE_USUARIO_ENTRETENIMENTO
ADD CONSTRAINT FK_SFE_USU_ENTv2
    FOREIGN KEY (CD_USUARIO)
    REFERENCES T_SFE_USUARIO (CD_USUARIO);
    
ALTER TABLE T_SFE_USUARIO_ENTRETENIMENTO
ADD CONSTRAINT FK_SFE_USU_ENT
    FOREIGN KEY (CD_ENTRETENIMENTO)
    REFERENCES T_SFE_ENTRETENIMENTO (CD_ENTRETENIMENTO);

/*-------------------------------------------------------------------------------*/

ALTER TABLE T_SFE_HISTORICO_EXERCICIO
ADD CONSTRAINT FK_SFE_HIST_EXE_USUARIO
    FOREIGN KEY (CD_USUARIO)
    REFERENCES T_SFE_USUARIO (CD_USUARIO);

/*-------------------------------------------------------------------------------*/

ALTER TABLE T_SFE_HISTORICO_FILME
ADD CONSTRAINT FK_SFE_HIST_FILME_USUARIO
    FOREIGN KEY (CD_USUARIO)
    REFERENCES T_SFE_USUARIO (CD_USUARIO);

/*-------------------------------------------------------------------------------*/

ALTER TABLE T_SFE_USUARIO_FILME
ADD CONSTRAINT FK_SFE_USU_FIL_USUARIO
    FOREIGN KEY (CD_USUARIO)
    REFERENCES T_SFE_USUARIO (CD_USUARIO);
    
ALTER TABLE T_SFE_USUARIO_FILME
ADD CONSTRAINT FK_SFE_USU_FIL_FILME
    FOREIGN KEY (CD_FILME)
    REFERENCES T_SFE_FILME (CD_FILME);

/*-------------------------------------------------------------------------------*/

ALTER TABLE T_SFE_USUARIO_EX_FISICO
ADD CONSTRAINT FK_SFE_USUARIO_EX_FISICOv2
    FOREIGN KEY (CD_USUARIO)
    REFERENCES T_SFE_USUARIO (CD_USUARIO);
    
ALTER TABLE T_SFE_USUARIO_EX_FISICO
ADD CONSTRAINT FK_SFE_USUARIO_EX_FISICO
    FOREIGN KEY (CD_EXERCICIO)
    REFERENCES T_SFE_EX_FISICO (CD_EXERCICIO);